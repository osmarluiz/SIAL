name: "UNet-EfficientNetB7"

model:
  architecture: "Unet"
  encoder: "efficientnet-b7"
  encoder_weights: "imagenet"
  activation: "softmax"
  in_channels: 3

training:
  learning_rate: 0.0001
  batch_size:
    train: 10
    val: 50
  num_epochs: 500
  device: "cuda"
  num_workers: 0

loss:
  train:
    name: "DWCCEMulticlass"
    params:
      eps: 1.0e-7
      confidence_threshold: 0.95
      # Curriculum learning: penalties ramp up during training
      uncertain_correct_penalty: 1.0    # Ramps to 1.5
      uncertain_wrong_penalty: 5.0      # Ramps to 15.0
      confident_wrong_penalty: 15.0     # Ramps to 50.0
      activation: null  # Model outputs softmax probabilities
      # ignore_index will be set from dataset config
  validation:
    name: "CrossEntropyLoss"
    params: {}

optimizer:
  name: "Adam"
  params:
    lr: 0.0001

metrics:
  - "mIoU"

# Model saving
checkpointing:
  save_best: true
  monitor_metric: "val_loss"
  mode: "min"
  save_interval: null  # Set to integer to save every N epochs
